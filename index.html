<!DOCTYPE html>
<html lang="ca">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Harmonia Arcana</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="assets/css/style.css" />
</head>
<body class="bg-brand-dark text-gray-100 min-h-screen flex justify-center p-4">

  <div class="w-full max-w-lg">

    <header class="text-center mb-6">
      <h1 class="text-white text-3xl font-bold">Harmonia Arcana</h1>
    </header>

    <main>

      <!-- LANDING -->
      <section id="landing-screen" class="screen active text-center space-y-6">
        <h2 class="text-2xl font-semibold">El teu DJ per a sessions de rol √®piques</h2>
        <button id="landing-start-btn" class="btn-action-primary w-3/4 mx-auto">Comen√ßar</button>
        <p id="version-display" class="text-xs text-gray-500">v13.3.7</p>
      </section>

      <!-- CAROUSEL DE GUIA -->
      <section id="carousel-screen" class="screen hidden card-bg p-6 rounded-xl space-y-6 text-sm">
        <h2 class="text-xl font-semibold mb-2">Guia pas a pas</h2>
        <div id="carousel-steps" class="space-y-3">
          <div class="carousel-step">
            <h3 class="text-lg font-bold">1. Inicia sessi√≥ a Hugging Face</h3>
            <p><a href="https://huggingface.co/login" target="_blank" class="text-purple-400 underline">huggingface.co/login</a></p>
          </div>
          <div class="carousel-step hidden">
            <h3 class="text-lg font-bold">2. Accepta l'√∫s del model</h3>
            <p><a href="https://huggingface.co/meta-llama/Llama-3-8B-Instruct" target="_blank" class="text-purple-400 underline">Llama 3.1</a></p>
          </div>
          <div class="carousel-step hidden">
            <h3 class="text-lg font-bold">3. Crea una clau API</h3>
            <p><a href="https://huggingface.co/settings/tokens" target="_blank" class="text-purple-400 underline">huggingface.co/settings/tokens</a></p>
          </div>
          <div class="carousel-step hidden">
            <h3 class="text-lg font-bold">4. Introdueix la teva clau</h3>
            <input id="api-key-input" type="password" class="input-styled" placeholder="hf_..."/>
            <button id="save-api-key-btn" class="btn-action-primary w-full mt-3">Desar clau i continuar</button>
          </div>
        </div>
        <div class="flex justify-between">
          <button id="carousel-prev" class="btn-control w-1/3">‚Üê Enrere</button>
          <button id="carousel-next" class="btn-control w-1/3">Seg√ºent ‚Üí</button>
        </div>
      </section>

      <!-- SELECCI√ì UNIVERS -->
      <section id="universe-selection-screen" class="screen hidden card-bg p-6 rounded-xl space-y-4">
        <h2 class="text-xl font-semibold text-center mb-4">Escull un univers sonor</h2>
        <div class="space-y-2">
          <button class="universe-card btn-control w-full" data-universe="jrpg">JRPG</button>
          <button class="universe-card btn-control w-full" data-universe="custom">Crea el teu univers</button>
        </div>
        <button id="change-api-key-btn" class="text-xs text-gray-500 hover:text-gray-300 mt-4">Canviar clau API</button>
      </section>

      <!-- PUJAR FITXERS -->
      <section id="upload-screen" class="screen hidden card-bg p-6 rounded-xl space-y-4">
        <h2 class="text-xl font-semibold">Puja les teves pistes</h2>
        <label>Combat: <input id="upload-combat" type="file" accept="audio/mp3"/></label>
        <label>Calma: <input id="upload-calma" type="file" accept="audio/mp3"/></label>
        <label>Misteri: <input id="upload-misteri" type="file" accept="audio/mp3"/></label>
        <button id="upload-done-btn" class="btn-action-primary w-full">Inicia la partida</button>
      </section>

      <!-- SESSI√ì ACTIVA -->
      <section id="session-screen" class="screen hidden card-bg p-6 rounded-xl space-y-4">
        <div class="flex justify-between items-center">
          <span id="music-status-dot" class="w-3 h-3 rounded-full bg-gray-500"></span>
          <span id="music-status-text">Aturada</span>
        </div>
        <textarea id="transcript-preview" readonly class="w-full h-24"></textarea>
        <div id="session-log" class="w-full h-24 overflow-y-auto text-sm border border-gray-600 rounded-md p-2 bg-black/30"></div>
        <div class="grid grid-cols-3 gap-2">
          <button id="toggle-listening-btn" class="btn-control">üéôÔ∏è Escoltar</button>
          <button id="stop-music-btn" class="btn-control">‚èπÔ∏è Atura m√∫sica</button>
          <button id="stop-session-btn" class="btn-control bg-red-600">üö™ Finalitzar</button>
        </div>
      </section>

    </main>

  </div>

  <!-- JS -->
  <script type="module" src="assets/js/config.js"></script>
  <script type="module" src="assets/js/ui.js"></script>
  <script type="module" src="assets/js/main.js"></script>
  <script type="module" src="assets/js/director.js"></script>
  <script type="module" src="assets/js/audioManager.js"></script>
  <script type="module" src="assets/js/ai.js"></script>
  <script type="module" src="assets/js/speech.js"></script>
</body>
</html>
